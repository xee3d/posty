@echo off
echo ========================================
echo Fix node_modules and Build
echo ========================================

cd C:\Users\xee3d\Documents\Posty_V74

echo.
echo [1] Removing node_modules...
rmdir /s /q node_modules 2>nul

echo.
echo [2] Removing package-lock.json...
del package-lock.json 2>nul

echo.
echo [3] Clearing npm cache...
npm cache clean --force

echo.
echo [4] Installing dependencies...
npm install

echo.
echo [5] Checking if native_modules.gradle exists...
if exist "node_modules\@react-native-community\cli-platform-android\native_modules.gradle" (
    echo SUCCESS: native_modules.gradle found!
) else (
    echo ERROR: native_modules.gradle not found!
    echo Trying to install @react-native-community/cli manually...
    npm install @react-native-community/cli @react-native-community/cli-platform-android
)

echo.
echo [6] Cleaning Android build...
cd android
call gradlew clean
cd ..

echo.
echo Installation complete! Now run:
echo   npx react-native run-android
echo.
pause